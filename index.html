<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Lynx Resources</title>
<style>
body {
  background: #0d0d0f;
  color: white;
  font-family: Arial;
  text-align: center;
}
.box {
  margin-top: 60px;
  background: #1a1a1d;
  padding: 30px;
  border-radius: 15px;
  width: 90%;
  margin-left: auto;
  margin-right: auto;
}
input, textarea {
  width: 90%;
  padding: 10px;
  margin: 10px;
  border-radius: 10px;
  border: none;
}
button {
  background: #6e00ff;
  border: none;
  padding: 12px 20px;
  color: white;
  border-radius: 10px;
  margin-top: 10px;
  width: 60%;
}
</style>
</head>

<body>
<h1>Lynx Resources</h1>

<div class="box">
<h2>Enviar script .lua</h2>

<input type="file" id="fileInput" accept=".lua">
<button onclick="upload()">Enviar</button>

<p id="result"></p>
</div>

<script>
async function upload() {
    const fileInput = document.getElementById("fileInput");
    if (!fileInput.files.length) return alert("Selecione um arquivo!");

    const file = fileInput.files[0];
    const content = await file.text();
    const filename = file.name;

    try {
        const res = await fetch("/api/upload", {  // CORRIGIDO: apontando para /api/upload
            method: "POST",
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ filename, content })
        });

        const data = await res.json();
        document.getElementById("result").innerText = data.loadstring || "Erro ao enviar!";
    } catch (err) {
        document.getElementById("result").innerText = "Erro de conex√£o!";
        console.error(err);
    }
}
</script>

</body>
</html>